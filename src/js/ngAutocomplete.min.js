angular.module("jkuri.autocomplete",[]).factory("ngAutocompleteService",["$http",function(b){var a=this;a.getData=function(d,c){return b.get(d,{query:c})};return a}]).directive("ngAutocomplete",["$timeout","$filter","ngAutocompleteService",function(c,e,a){var d={left:37,up:38,right:39,down:40,enter:13,esc:27};var f=function(h,g){h.url=g.url||null;h.searchProperty=g.searchProperty||"title";h.maxResults=g.maxResults||10;h.delay=parseInt(g.delay,10)||300;h.minLenth=parseInt(g.minLenth,10)||2;h.allowOnlyResults=h.$eval(g.allowOnlyResults)||false;h.placeholder=g.placeholder||"Search ...";h.theme=g.theme||""};var b=(function(){var g=0;return function(i,h){c.cancel(g);g=c(i,h)}})();return{restrict:"E",require:"?ngModel",scope:true,link:function(i,h,g,j){f(i,g);i.results=[];i.currentIndex=null;i.getResults=function(){if(parseInt(i.keyword.length,10)===0){i.results=[]}if(i.keyword.length<i.minLenth){return}b(function(){a.getData(i.url,i.keyword).then(function(m){i.results=[];var k=e("filter")(m.data,{title:i.keyword});for(var l=0;l<i.maxResults;l++){i.results.push(k[l])}i.currentIndex=0;if(i.results.length){i.showResults=true}})},i.delay)};i.selectResult=function(k){i.keyword=k.title;j.$setViewValue(k.title);i.showResults=false};i.clearResults=function(){i.results=[];i.currentIndex=null};i.hoverResult=function(k){i.currentIndex=k};i.blurHandler=function(){c(function(){if(i.allowOnlyResults){var k=e("filter")(i.results,{title:i.keyword},true);if(!k.length){i.keyword="";j.$setViewValue("")}}i.showResults=false},100)};i.keyupHandler=function(l){var k=l.which||l.keyCode;if(k===d.enter){i.selectResult(i.results[i.currentIndex])}if(k===d.left||k===d.up){if(i.currentIndex>0){i.currentIndex-=1}}if(k===d.right||k===d.down){if(i.currentIndex<i.maxResults-1){i.currentIndex+=1}}if(k===d.esc){i.keyword="";j.$setViewValue("");i.clearResults()}}},template:'<input type="text" ng-model="keyword" class="ng-autocomplete-input" placeholder="{{ placeholder }}" ng-change="getResults()" ng-keyup="keyupHandler($event)" ng-blur="blurHandler()" ng-focus="currentIndex = 0" autocorrect="off" autocomplete="off"><div class="ng-autocomplete-holder" ng-show="showResults" ng-class="{\'red\': theme === \'red\', \'green\': theme === \'green\', \'blue\': theme === \'blue\'}">  <div class="ng-autocomplete-result" ng-repeat="r in results | filter : {title: keyword}" ng-click="selectResult(r)" ng-mouseover="hoverResult($index)" ng-class="{\'hover\': $index === currentIndex}">    <span class="ng-autocomplete-result-title">{{ r.title }}</span>    <span class="ng-autocomplete-result-description" ng-show="r.description !== \'\'">{{ r.description }}</span>  </div></div>'}}]);